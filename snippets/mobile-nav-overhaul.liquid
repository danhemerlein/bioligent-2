{{ 'mobile-nav-overhaul.css' | asset_url | stylesheet_tag }}
{{ 'mobile-nav-toggle.css' | asset_url | stylesheet_tag }}

<ul class="new-mobile-nav__ul">
  <li class="js-new-mobile-nav-product-container new-mobile-nav__product">
    {% if products_list != blank %}
      <div class="new-mobile-nav__product-grid new-mobile-nav__with-border {% if mobile_columns == 'two' %} new-mobile-nav__two-column-grid {% elsif mobile_columns == 'three' %} new-mobile-nav__three-column-grid {% elsif mobile_columns == 'four' %} new-mobile-nav__four-column-grid {% endif %}">
        {% for product in products_list %}
          <a href="{{ product.url }}">
            <img class="new-mobile-nav__product-image" src="{{ product.featured_image | img_url: '300x300' }}" alt="{{ product.title }}">
            <p class="new-mobile-nav__product-title ">
              {{ product.title }}
            </p>
          </a>
        {% endfor %}
      </div>
    {% endif %}

    {% if collection_list != blank %}
      {% for collection in collection_list %}
        <div class="new-mobile-nav__collection-dropdown">

          <div class="js-new-mobile-nav-dropdown-trigger new-mobile-nav__collection-dropdown-header" data-collection-id="{{ collection.id }}">
            <p class="new-mobile-nav__collection-title text-weight--bold text-size--large">
              {{ collection.title }}
            </p>
            <span class="icon-chevron">{%- render 'theme-symbols', icon: 'chevron-2' -%}</span>
          </div>

          <div class="new-mobile-nav__hr"></div>


          <div class="new-mobile-nav__collection-dropdown-content" data-collection-id="{{ collection.id }}">
            {%- liquid
      
              if settings.product_card_aspect_ratio == 'natural'
                if item.media.size == 0 or blank_product
                  assign aspect_ratio = 1
                else
                  unless item.featured_media.aspect_ratio > 0
                    assign aspect_ratio = 1
                  else
                    assign aspect_ratio = item.featured_media.aspect_ratio
                  endunless
                endif
              else
                assign aspect_ratio = settings.product_card_aspect_ratio
              endif
              

            -%}
            {% for item in collection.products %}

              {%- liquid
                assign image = item.featured_media
              -%}
              <a href="{{ item.url }}">
                <div style="padding-top:{{ 100 | divided_by: aspect_ratio }}%; position: relative;" class="new-mobile-nav__product-item">
                  {%- capture sizes -%}
                    sizes="(max-width: {{ settings.theme_max_width }}px) calc((100vw - 200px) / 6), {{ settings.theme_max_width | divided_by: 6 }}px"
                  {%- endcapture -%}
  
                  {%- liquid
                    if image != blank
                      assign image_class = 'product-item__image-figure lazy-image--zoom-animation lazy-image--to-reveal'
                      render 'lazy-image', image: image, alt: item.title, ratio: aspect_ratio, type: 'background', class: image_class, sizes: sizes   
                    endif
                  -%}
  
                  <div class="mega-menu-product-item__title">
                    <span class="text-size--regular text-weight--bold">
                      {{ item.title | escape}}
                    </span>
                  </div>      
                  <div class="product-item__price mega-menu-product-item__price">
                    {%- render 'product-price', target: item, variant: product_variant, product_price_varies: item.price_varies -%}
                  </div>
                </div>
              </a>
            {% endfor %}
          </div>
        </div>
      {% endfor %}
    {% endif %}
  </li>

  <li class="js-new-mobile-nav-learn-container new-mobile-nav__learn" style="display: none;">
    {% for block in blocks %}
      {% case block.type %}
      {%- when 'menu' -%}
        {% for link in linklists[block.settings.linklist].links %}
          {%- for childlink in link.links -%}
            <div class="new-mobile-nav__learn-item">
            <a href="{{ childlink.url }}">
              {%- liquid
                assign image_class = 'mega-menu-product-item__image product-item__image-figure lazy-image--zoom-animation'
                if block.settings.site_nav_image_one != blank and forloop.index == 1
                  render 'lazy-image', image: block.settings.site_nav_image_one, class: image_class   
                endif

                if block.settings.site_nav_image_two != blank and forloop.index == 2
                  render 'lazy-image', image: block.settings.site_nav_image_two, class: image_class   
                endif

                if block.settings.site_nav_image_three != blank and forloop.index == 3
                  render 'lazy-image', image: block.settings.site_nav_image_three, class: image_class   
                endif

                if block.settings.site_nav_image_four != blank and forloop.index == 4
                  render 'lazy-image', image: block.settings.site_nav_image_four, class: image_class   
                endif
              -%}

              <p class="text-weight--bold text-size--large">
                {{ childlink.title | escape }}
              </p>

              <span class="learn-menu-link-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="33" height="33" viewBox="0 0 33 33" fill="none">
                  <path d="M16.25 3.54541C13.6788 3.54541 11.1654 4.30785 9.02759 5.73631C6.88975 7.16476 5.22351 9.19509 4.23957 11.5705C3.25563 13.946 2.99819 16.5598 3.4998 19.0816C4.00141 21.6033 5.23953 23.9197 7.05762 25.7378C8.8757 27.5559 11.1921 28.794 13.7138 29.2956C16.2356 29.7972 18.8495 29.5398 21.2249 28.5558C23.6003 27.5719 25.6307 25.9057 27.0591 23.7678C28.4876 21.63 29.25 19.1166 29.25 16.5454C29.2464 13.0987 27.8756 9.79423 25.4384 7.35704C23.0012 4.91986 19.6967 3.54905 16.25 3.54541ZM16.25 27.5454C14.0744 27.5454 11.9477 26.9003 10.1387 25.6916C8.32979 24.4829 6.91989 22.7649 6.08733 20.7549C5.25477 18.7449 5.03693 16.5332 5.46137 14.3994C5.88581 12.2656 6.93345 10.3056 8.47183 8.76724C10.0102 7.22886 11.9702 6.18121 14.104 5.75677C16.2378 5.33233 18.4495 5.55017 20.4595 6.38274C22.4695 7.2153 24.1875 8.6252 25.3962 10.4341C26.6049 12.2431 27.25 14.3698 27.25 16.5454C27.2467 19.4618 26.0867 22.2577 24.0245 24.3199C21.9623 26.3821 19.1664 27.5421 16.25 27.5454ZM21.9575 15.8379C22.0505 15.9308 22.1242 16.0411 22.1746 16.1625C22.2249 16.2839 22.2508 16.414 22.2508 16.5454C22.2508 16.6768 22.2249 16.807 22.1746 16.9284C22.1242 17.0497 22.0505 17.16 21.9575 17.2529L17.9575 21.2529C17.7699 21.4406 17.5154 21.546 17.25 21.546C16.9846 21.546 16.7301 21.4406 16.5425 21.2529C16.3549 21.0653 16.2494 20.8108 16.2494 20.5454C16.2494 20.28 16.3549 20.0256 16.5425 19.8379L18.8363 17.5454H11.25C10.9848 17.5454 10.7304 17.4401 10.5429 17.2525C10.3554 17.065 10.25 16.8106 10.25 16.5454C10.25 16.2802 10.3554 16.0258 10.5429 15.8383C10.7304 15.6508 10.9848 15.5454 11.25 15.5454H18.8363L16.5425 13.2529C16.3549 13.0653 16.2494 12.8108 16.2494 12.5454C16.2494 12.28 16.3549 12.0256 16.5425 11.8379C16.7301 11.6503 16.9846 11.5449 17.25 11.5449C17.5154 11.5449 17.7699 11.6503 17.9575 11.8379L21.9575 15.8379Z" fill="white"/>
                </svg>
              </span>  
              </a>
            </div>
          {% endfor %}
        {% endfor %}
      {% endcase %}
    {% endfor %}
  </li>

  <div class="new-mobile-nav__hr"></div>

  <li class="new-mobile-nav__links-container">
    <div class="new-mobile-nav__promo-link-container">
      <a href="{{ sub_save_url }}" class="new-mobile-nav__promo-link">
        <img class="new-mobile-nav__promo-image" src="{{ sub_save_image | img_url: '300x300' }}" alt="{{ sub_save_cta }}">

        <div class="new-mobile-nav__promo-title-container">
          <p class="new-mobile-nav__promo-title text-weight--bold text-size--large">
            {{ sub_save_cta }}
          </p>
        </div>
      </a>
    </div>

    <div class="new-mobile-nav__promo-link-container">
      <a href="{{ sub_save_url_two }}" class="new-mobile-nav__promo-link">
        <img class="new-mobile-nav__promo-image" src="{{ sub_save_image_two | image_url: width: 300, height: 300 }}" alt="{{ sub_save_cta_two }}">

        <div class="new-mobile-nav__promo-title-container">
          <p class="new-mobile-nav__promo-title text-weight--bold text-size--large">
            {{ sub_save_cta_two }}
          </p>
        </div>
      </a>
    </div>
  </li>

  <div class="new-mobile-nav__hr"></div>

  <div class="new-mobile-nav__links-container">
  {% for link in linklists[text_link_list].links %}
    <li>
      <a class="text-weight--bold text-size--large" href="{{ link.url }}">
        {{ link.title }}
      </a>
    </li>
  {% endfor %}
  </div>

</ul>
